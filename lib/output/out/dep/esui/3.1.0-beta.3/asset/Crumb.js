/*! @2014 Leo Wang. All Rights Reserved */
define("esui/Crumb",["require","underscore","./lib","./Control","./painters","./main"],function(require){function e(){i.apply(this,arguments)}var t=require("underscore"),n=require("./lib"),i=require("./Control");e.defaultProperties={separator:">"},e.prototype.type="Crumb",e.prototype.initOptions=function(i){var a={path:[]};t.extend(a,e.defaultProperties,i);var o=n.getChildren(this.main);if(!i.path&&o.length)a.path=t.map(o,function(e){var t={text:n.getText(e)};if("a"===e.nodeName.toLowerCase())t.href=n.getAttribute(e,"href");return t});this.setProperties(a)},e.prototype.textNodeTemplate='<span class="${classes}">${text}</span>',e.prototype.linkNodeTemplate='<a class="${classes}" href="${href}">${text}</a>',e.prototype.separatorTemplate='<span class="${classes}">${text}</span>',e.prototype.getNodeHTML=function(e,i){var a=this.helper.getPartClasses("node");if(0===i)a.push.apply(a,this.helper.getPartClasses("node-first"));if(i===this.path.length-1)a.push.apply(a,this.helper.getPartClasses("node-last"));var o=e.href?this.linkNodeTemplate:this.textNodeTemplate,s={href:t.escape(e.href),text:t.escape(e.text),classes:a.join(" ")};return n.format(o,s)},e.prototype.getSeparatorHTML=function(){return n.format(this.separatorTemplate,{classes:this.helper.getPartClassName("separator"),text:t.escape(this.separator)})};var a=require("./painters");return e.prototype.repaint=a.createRepaint(i.prototype.repaint,{name:["path","separator"],paint:function(e,n){var i=t.map(n,e.getNodeHTML,e),a=e.getSeparatorHTML();e.main.innerHTML=i.join(a)}}),require("./main").register(e),n.inherits(e,i),e});