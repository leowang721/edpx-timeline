/*! @2014 Leo Wang. All Rights Reserved */
define("echarts/util/shape/Chain",["require","zrender/shape/Base","./Icon","zrender/shape/util/dashedLineTo","zrender/tool/util","zrender/tool/matrix"],function(require){function e(e){t.call(this,e)}var t=require("zrender/shape/Base"),n=require("./Icon"),i=require("zrender/shape/util/dashedLineTo"),a=require("zrender/tool/util"),o=require("zrender/tool/matrix");return e.prototype={type:"chain",brush:function(e,t){var n=this.style;if(t)n=this.getHighlightStyle(n,this.highlightStyle||{});e.save(),this.setContext(e,n),this.setTransform(e),e.save(),e.beginPath(),this.buildLinePath(e,n),e.stroke(),e.restore(),this.brushSymbol(e,n),e.restore()},buildLinePath:function(e,t){var n=t.x,a=t.y+5,o=t.width,s=t.height/2-10;if(e.moveTo(n,a),e.lineTo(n,a+s),e.moveTo(n+o,a),e.lineTo(n+o,a+s),e.moveTo(n,a+s/2),!t.lineType||"solid"==t.lineType)e.lineTo(n+o,a+s/2);else if("dashed"==t.lineType||"dotted"==t.lineType){var l=(t.lineWidth||1)*("dashed"==t.lineType?5:1);i(e,n,a+s/2,n+o,a+s/2,l)}},brushSymbol:function(e,t){var i=t.y+t.height/4;e.save();for(var a,o=t.chainPoint,s=0,l=o.length;l>s;s++){if(a=o[s],"none"!=a.symbol){e.beginPath();var r=a.symbolSize;n.prototype.buildPath(e,{iconType:a.symbol,x:a.x-r,y:i-r,width:2*r,height:2*r,n:a.n}),e.fillStyle=a.isEmpty?"#fff":t.strokeColor,e.closePath(),e.fill(),e.stroke()}if(a.showLabel)if(e.font=a.textFont,e.fillStyle=a.textColor,e.textAlign=a.textAlign,e.textBaseline=a.textBaseline,a.rotation)e.save(),this._updateTextTransform(e,a.rotation),e.fillText(a.name,a.textX,a.textY),e.restore();else e.fillText(a.name,a.textX,a.textY)}e.restore()},_updateTextTransform:function(e,t){var n=o.create();if(o.identity(n),0!==t[0]){var i=t[1]||0,a=t[2]||0;if(i||a)o.translate(n,n,[-i,-a]);if(o.rotate(n,n,t[0]),i||a)o.translate(n,n,[i,a])}e.transform.apply(e,n)},isCover:function(e,t){var n=this.style;if(e>=n.x&&e<=n.x+n.width&&t>=n.y&&t<=n.y+n.height)return!0;else return!1}},a.inherits(e,t),e});