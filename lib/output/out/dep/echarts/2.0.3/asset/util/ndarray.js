/*! @2014 Leo Wang. All Rights Reserved */
define("echarts/util/ndarray",["require","./kwargs"],function(require){"use strict";function e(e){if("undefined"==typeof e)return"number";switch(Object.prototype.toString.call(e)){case"[object Int32Array]":return"int32";case"[object Int16Array]":return"int16";case"[object Int8Array]":return"int8";case"[object Uint32Array]":return"uint32";case"[object Uint16Array]":return"uint16";case"[object Uint8Array]":return"uint8";case"[object Uint8ClampedArray]":return"uint8c";case"[object Float32Array]":return"float32";case"[object Float64Array]":return"float64";default:return"number"}}function t(e,t){if(e.indexOf(":")>=0){var n,i,a=e.split(/\s*:\s*/),o=parseInt(a[2]||1,10);if(0===o)throw new Error("Slice step cannot be zero");else if(o>0)n=parseInt(a[0]||0,10),i=parseInt(a[1]||t,10);else n=parseInt(a[0]||t-1,10),i=parseInt(a[1]||-1,10);if(0>n)n=t+n;if(0>i&&a[1])i=t+i;if(o>0)n=Math.max(Math.min(t,n),0),i=Math.max(Math.min(t,i),0);else n=Math.max(Math.min(t-1,n),-1),i=Math.max(Math.min(t-1,i),-1);return[n,i,o]}else{var n=parseInt(e,10);if(0>n)n=t+n;if(0>n||n>t)throw new Error(U(e));return n=Math.max(Math.min(t-1,n),0),[n,n+1,1]}}function n(e){for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function i(e){for(var t=1,n=e[0];n instanceof Array;)n=n[0],t++;return t}function a(e){for(var t=[e.length],n=e[0];n instanceof Array;)t.push(n.length),n=n[0];return t}function o(e,t){if(t==e.length-1)return 1;for(var n=e[t+1],i=t+2;i<e.length;i++)n*=e[i];return n}function s(e){for(var t=[],i=1,a=n(e),o=0;o<e.length;o++)i*=e[o],t.push(a/i);return t}function l(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function r(e,t){return"Shape ("+e.toString()+") ("+t.toString()+") could not be broadcast together"}function V(e){return"Axis "+e+" out of bounds"}function U(e){return"Index "+e+" out of bounds"}var h=require("./kwargs"),m=Array.prototype.slice;this.Int32Array=window.Int32Array||Array,this.Int16Array=window.Int16Array||Array,this.Int8Array=window.Int8Array||Array,this.Uint32Array=window.Uint32Array||Array,this.Uint16Array=window.Uint16Array||Array,this.Uint8Array=window.Uint8Array||Array,this.Float32Array=window.Float32Array||Array,this.Float64Array=window.Float64Array||Array;var p={int32:this.Int32Array,int16:this.Int16Array,int8:this.Int8Array,uint32:this.Uint32Array,uint16:this.Uint16Array,uint8:this.Uint8Array,uint8c:this.Uint8ClampedArray,float32:this.Float32Array,float64:this.Float64Array,number:Array},d={int32:4,int16:2,int8:1,uint32:4,uint16:2,uint8:1,uint8c:1,float32:4,float64:8,number:1},c=0,b=1,y=2,k=3,f=4,u=5,g=6,L=7,x=8,_=function(t){var n=arguments[arguments.length-1];if("string"==typeof n)this._dtype=n;else this._dtype=e(t);if(t&&"string"!=typeof t){if(t instanceof _)return t._dtype=this._dtype,t;else if("undefined"!=typeof t.length)this.initFromArray(t);else if("number"==typeof t)this.initFromShape.apply(this,arguments)}else this._array=new p[this._dtype],this._shape=[0],this._size=0};return _.prototype={initFromArray:function(e){function t(e,n,i){for(var a=i.length,l=0;a>l;l++)if(o-1>e)t(e+1,n,i[l]);else n[s++]=i[l]}var o=i(e),s=0,l=a(e),r=n(l);return this._array=new p[this._dtype](r),t(0,this._array,e),this._shape=l,this._size=r,this},initFromShape:function(e){if("number"==typeof e)e=Array.prototype.slice.call(arguments);if(e){var t=n(e);if("number"===this._dtype){this._array=[];for(var i=this._array,a=0;t>a;a++)i[a]=0}else this._array=new p[this._dtype](t)}return this._shape=e,this._size=n(e),this},fill:function(e){for(var t=this._array,n=0;n<t.length;n++)t[n]=e;return this},shape:function(){return this._shape.slice()},size:function(){return this._size},dtype:function(){return this._dtype},dimension:function(){return this._shape.length},strides:function(){for(var e=s(this._shape),t=d[this._dtype],n=0;n<e.length;n++)e[n]*=t;return e},reshape:function(e){if("number"==typeof e)e=Array.prototype.slice.call(arguments);if(this._isShapeValid(e))this._shape=e;else throw new Error("Total size of new array must be unchanged");return this},_isShapeValid:function(e){return n(e)===this._size},resize:function(e){if("number"==typeof e)e=Array.prototype.slice.call(arguments);var t=n(e);if(t<this._size){if("number"===this._dtype)this._array.length=t}else if("number"===this._dtype)for(var i=this._array.length;t>i;i++)this._array[i]=0;else{for(var a=new p[this._dtype](t),o=this._array,i=0;i<o.length;i++)a[i]=o[i];this._array=a}return this._shape=e,this._size=t,this},transpose:h(function(e,t){for(var n=[],i=0;i<this._shape.length;i++)n.push(i);if("undefined"==typeof e)e=n.slice();for(var i=0;i<e.length;i++)if(e[i]>=this._shape.length)throw new Error(V(e[i]));if(e.length<=1)return this;for(var a=n.slice(),i=0;i<Math.floor(e.length/2);i++)for(var o=e.length-1;o>=Math.ceil(e.length/2);o--)a[e[i]]=e[o],a[e[o]]=e[i];return this._transposelike(a,t)}),swapaxes:h(function(e,t,n){return this.transpose([e,t],n)}),rollaxis:h(function(e,t,n){if(e>=this._shape.length)throw new Error(V(e));for(var i=[],a=0;a<this._shape.length;a++)i.push(a);return i.splice(e,1),i.splice(t,0,e),this._transposelike(i,n)},{start:0}),_transposelike:function(e,t){function n(e,t,s){var r=a[e],V=o[e],U=m[e];if(l-1>e)for(var h=0;r>h;h++)n(e+1,t+V*h,s+U*h);else for(var h=0;r>h;h++)d[s+h]=i[t+V*h]}for(var i=this._array,a=this._shape.slice(),o=s(this._shape),l=a.length,r=[],V=[],U=0;U<e.length;U++){var h=e[U];V[U]=a[h],r[U]=o[h]}o=r,a=V,this._shape=a;var m=s(this._shape);if(!t)t=new _,t._shape=this._shape.slice(),t._dtype=this._dtype,t._size=this._size;var d=new p[this._dtype](this._size);return t._array=d,n(0,0,0),t},repeat:h(function(e,t,n){var i;if("undefined"==typeof t)i=[this._size],t=0;else i=this._shape.slice();var a=i.slice();if(i[t]*=e,!n)n=new _(this._dtype),n.initFromShape(i);else if(!l(i,n._shape))throw new Error(r(i,n._shape));for(var s=n._array,V=o(a,t),U=a[t],h=this._array,m=V*U,p=0;p<this._size;p+=m)for(var d=0;V>d;d++)for(var c=p+d,b=p*e+d,y=0;U>y;y++){for(var k=0;e>k;k++)s[b]=h[c],b+=V;c+=V}return n}),choose:function(){console.warn("TODO")},take:function(){console.warn("TODO")},tile:function(){console.warn("TODO")},_withPreprocess1:function(e,t,n,i){var a=this._array;if(this._size)if("undefined"!=typeof e){if(0>e)e=this._shape.length+e;if(e>=this._shape.length||0>e)throw new Error(V(e));var s=this._shape.slice();if(s.splice(e,1),t&&!l(s,t._shape))throw new Error(r(s,t._shape));if(!t)t=new _(this._dtype),t.initFromShape(s);var U=t._array,h=o(this._shape,e),m=this._shape[e],p=h*m;return n.call(this,U,a,p,m,h),t}else return i.call(this,a)},_withPreprocess2:function(e,t,n,i){var a=this._array;if(this._size){if(t&&!l(this._shape,t._shape))throw new Error(r(this._shape,t._shape));if(!t)t=new _(this._dtype),t.initFromShape(this._shape);var s=t._array;if("undefined"!=typeof e){if(0>e)e=this._shape.length+e;if(e>=this._shape.length||0>e)throw new Error(V(e));if(e>=this._shape.length)throw new Error(V(e));var U=o(this._shape,e),h=this._shape[e],m=U*h;n.call(this,s,a,m,h,U)}else t.reshape([this._size]),i.call(this,s,a);return t}},max:h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=l+s,V=t[r],U=0;i>U;U++){var h=t[r];if(h>V)V=h;r+=a}e[o++]=V}}function t(e){for(var t=e[0],n=1;n<this._size;n++)if(e[n]>t)t=e[n];return t}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),min:h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=l+s,V=t[r],U=0;i>U;U++){var h=t[r];if(V>h)V=h;r+=a}e[o++]=V}}function t(e){for(var t=e[0],n=1;n<this._size;n++)if(e[n]<t)t=e[n];return t}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),argmax:h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=0,V=l+s,U=t[V],h=0;i>h;h++){var m=t[V];if(m>U)U=m,r=h;V+=a}e[o++]=r}}function t(e){for(var t=e[0],n=0,i=1;i<this._size;i++)if(e[i]>t)n=i,t=e[i];return n}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),argmin:h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=0,V=l+s,U=t[V],h=0;i>h;h++){var m=t[V];if(U>m)U=m,r=h;V+=a}e[o++]=r}}function t(e){for(var t=e[0],n=0,i=1;i<this._size;i++)if(e[i]<t)n=i,t=e[i];return n}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),sum:h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=0,V=l+s,U=0;i>U;U++)r+=t[V],V+=a;e[o++]=r}}function t(e){for(var t=0,n=0;n<this._size;n++)t+=e[n];return t}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),prod:h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=1,V=l+s,U=0;i>U;U++)r*=t[V],V+=a;e[o++]=r}}function t(e){for(var t=1,n=0;n<this._size;n++)t*=e[n];return t}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),mean:h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=0,V=l+s,U=0;i>U;U++)r+=t[V],V+=a;var h=r/i;e[o++]=h}}function t(e){for(var t=0,n=e.length,i=0;n>i;i++)t+=e[i];var a=t/n;return a}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),"var":h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=0,V=l+s,U=0;i>U;U++)r+=t[V],V+=a;var h=r/i,m=0;V=l+s;for(var U=0;i>U;U++){var p=t[V]-h;m+=p*p,V+=a}e[o++]=m/i}}function t(e){for(var t=0,n=e.length,i=0;n>i;i++)t+=e[i];for(var a=t/n,o=0,i=0;n>i;i++){var s=e[i]-a;o+=s*s}return o/n}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),std:h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=0,V=l+s,U=0;i>U;U++)r+=t[V],V+=a;var h=r/i,m=0;V=l+s;for(var U=0;i>U;U++){var p=t[V]-h;m+=p*p,V+=a}e[o++]=Math.sqrt(m/i)}}function t(e){for(var t=0,n=e.length,i=0;n>i;i++)t+=e[i];for(var a=t/n,o=0,i=0;n>i;i++){var s=e[i]-a;o+=s*s}return Math.sqrt(o/n)}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),ptp:h(function(){function e(e,t,n,i,a){for(var o=0,s=0;s<this._size;s+=n)for(var l=0;a>l;l++){for(var r=s+l,V=t[r],U=t[r],h=0;i>h;h++){var m=t[r];if(V>m)V=m;if(m>U)U=m;r+=a}e[o++]=U-V}}function t(e){for(var t=e[0],n=e[0],i=1;i<this._size;i++){if(e[i]<t)t=e[i];if(e[i]>n)n=e[i]}return n-t}return function(n,i){return this._withPreprocess1(n,i,e,t)}}()),sort:h(function(e,t){if(0>e)e=this._shape.length+e;var n;if("ascending"===t)n=function(e,t){return e-t};else if("descending"===t)n=function(e,t){return t-e};for(var i=this._array,a=o(this._shape,e),s=this._shape[e],l=a*s,r=new Array(s),V=0;V<this._size;V+=l)for(var U=0;a>U;U++){for(var h=V+U,m=0;s>m;m++)r[m]=i[h],h+=a;r.sort(n);for(var h=V+U,m=0;s>m;m++)i[h]=r[m],h+=a}return this},{axis:-1,order:"ascending"}),argsort:h(function(e,t,n){if(0>e)e=this._shape.length+e;if(this._size){if(n&&!l(this._shape,n._shape))throw new Error(r(this._shape,n._shape));if(!n)n=new _(this._dtype),n.initFromShape(this._shape);var i,a=n._array;if("ascending"===t)i=function(e,t){return m[e]-m[t]};else if("descending"===t)i=function(e,t){return m[t]-m[e]};for(var s=this._array,V=o(this._shape,e),U=this._shape[e],h=V*U,m=new Array(U),p=new Array(U),d=0;d<this._size;d+=h)for(var c=0;V>c;c++){for(var b=d+c,y=0;U>y;y++)m[y]=s[b],p[y]=y,b+=V;p.sort(i);for(var b=d+c,y=0;U>y;y++)a[b]=p[y],b+=V}return n}},{axis:-1,order:"ascending"}),cumsum:h(function(){function e(e,t,n,i,a){for(var o=0;o<this._size;o+=n)for(var s=0;a>s;s++){var l=o+s,r=l;e[l]=t[l];for(var V=1;i>V;V++)r=l,l+=a,e[l]=e[r]+t[l]}}function t(e,t){e[0]=t[0];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n]}return function(n,i){return this._withPreprocess2(n,i,e,t)}}()),cumprod:h(function(){function e(e,t,n,i,a){for(var o=0;o<this._size;o+=n)for(var s=0;a>s;s++){var l=o+s,r=l;e[l]=t[l];for(var V=1;i>V;V++)r=l,l+=a,e[l]=e[r]*t[l]}}function t(e,t){e[0]=t[0];for(var n=1;n<e.length;n++)e[n]=e[n-1]*t[n]}return function(n,i){return this._withPreprocess2(n,i,e,t)}}()),dot:function(){console.warn("TODO")},map:function(e,t){for(var n=this._array,i=this._array,a=n[0],o=n[0],s=this._size,l=1;s>l;l++){var r=n[l];if(a>r)a=r;if(r>o)o=r}for(var V=o-a,U=t-e,l=0;s>l;l++)if(0===V)i[l]=e;else{var r=n[l],h=(r-a)/V;i[l]=U*h+e}return this},add:function(e,t){return this.binaryOperation(this,e,c,t)},sub:function(e,t){return this.binaryOperation(this,e,b,t)},mul:function(e,t){return this.binaryOperation(this,e,y,t)},div:function(e,t){return this.binaryOperation(this,e,k,t)},mod:function(e,t){return this.binaryOperation(this,e,f,t)},and:function(e,t){return this.binaryOperation(this,e,u,t)},or:function(e,t){return this.binaryOperation(this,e,g,t)},xor:function(e,t){return this.binaryOperation(this,e,L,t)},equal:function(e,t){return this.binaryOperation(this,e,x,t)},binaryOperation:function(e,t,n,i){var a=[],s="number"==typeof e,V="number"==typeof t;if(s)a=t._shape.slice();else if(V)a=e._shape.slice();else{for(var U=e._shape.length-1,h=t._shape.length-1,m=e,p=t;U>=0&&h>=0;){if(1==e._shape[U])a.unshift(t._shape[h]),m=e.repeat(t._shape[h],U);else if(1==t._shape[h])a.unshift(e._shape[U]),p=t.repeat(e._shape[U],h);else if(t._shape[h]==e._shape[U])a.unshift(e._shape[U]);else throw new Error(r(e._shape,t._shape));U--,h--}for(var d=U;d>=0;d--)a.unshift(e._shape[d]);for(var d=h;d>=0;d--)a.unshift(t._shape[d]);e=m,t=p}if(!i)i=new _(this._dtype),i.initFromShape(a);else if(!l(a,i._shape))throw new Error(r(a,i._shape));var W,X,K,w,I=i._array;if(s)W=t._shape.length-1,X=!1,K=e,w=t._array;else if(V)W=e._shape.length-1,X=!0,w=t,K=e._array;else W=Math.abs(e._shape.length-t._shape.length),X=e._shape.length>=t._shape.length,K=e._array,w=t._array;var J,C,v,S=o(a,W),F=a[W],A=S*F,E=i._size/A,O=0;if(X)if(V)for(var z=0;E>z;z++)for(var d=0;A>d;d++){switch(J=K[O],C=w,n){case c:v=J+C;break;case b:v=J-C;break;case y:v=J*C;break;case k:v=J/C;break;case f:v=J%C;break;case u:v=J&C;break;case g:v=J|C;break;case L:v=J^C;break;case x:v=J==C;break;default:throw new Error("Unkown operation "+n)}I[O]=v,O++}else for(var z=0;E>z;z++)for(var d=0;A>d;d++){switch(J=K[O],C=w[d],n){case c:v=J+C;break;case b:v=J-C;break;case y:v=J*C;break;case k:v=J/C;break;case f:v=J%C;break;case u:v=J&C;break;case g:v=J|C;break;case L:v=J^C;break;case x:v=J==C;break;default:throw new Error("Unkown operation "+n)}I[O]=v,O++}else if(s)for(var z=0;E>z;z++)for(var d=0;A>d;d++){switch(J=K,C=w[O],n){case c:v=J+C;break;case b:v=J-C;break;case y:v=J*C;break;case k:v=J/C;break;case f:v=J%C;break;case u:v=J&C;break;case g:v=J|C;break;case L:v=J^C;break;case x:v=J==C;break;default:throw new Error("Unkown operation "+n)}I[O]=v,O++}else for(var z=0;E>z;z++)for(var d=0;A>d;d++){switch(J=K[O],C=w[d],n){case c:v=J+C;break;case b:v=J-C;break;case y:v=J*C;break;case k:v=J/C;break;case f:v=J%C;break;case u:v=J&C;break;case g:v=J|C;break;case L:v=J^C;break;case x:v=J==C;break;default:throw new Error("Unkown operation "+n)}I[O]=v,O++}return i},neg:function(){for(var e=this._array,t=0;t<this._size;t++)e[t]=-e[t];return this},sin:function(){return this._mathAdapter(Math.sin)},cos:function(){return this._mathAdapter(Math.cos)},tan:function(){return this._mathAdapter(Math.tan)},abs:function(){return this._mathAdapter(Math.abs)},log:function(){return this._mathAdapter(Math.log)},sqrt:function(){return this._mathAdapter(Math.sqrt)},ceil:function(){return this._mathAdapter(Math.ceil)},floor:function(){return this._mathAdapter(Math.floor)},pow:function(e){for(var t=this._array,n=0;n<this._size;n++)t[n]=Math.pow(t[n],e);return this},_mathAdapter:function(e){for(var t=this._array,n=0;n<this._size;n++)t[n]=e(t[n]);return this},round:function(e){e=Math.floor(e||0);var t=Math.pow(10,e),n=this._array;if(0===e)for(var i=0;i<this._size;i++)n[i]=Math.round(n[i]);else for(var i=0;i<this._size;i++)n[i]=Math.round(n[i]*t)/t;return this},clip:function(e,t){for(var n=this._array,i=0;i<this._size;i++)n[i]=Math.max(Math.min(n[i],t),e);return this},get:function(e,t){function n(e,t){var a=o[e],s=i[e];if(V-1>e)if(a[2]>0)for(var l=a[0];l<a[1];l+=a[2])n(e+1,t+s*l);else for(var l=a[0];l>a[1];l+=a[2])n(e+1,t+s*l);else if(a[2]>0)for(var l=a[0];l<a[1];l+=a[2])for(var m=0;s>m;m++)r[h++]=U[l*s+m+t];else for(var l=a[0];l>a[1];l+=a[2])for(var m=0;s>m;m++)r[h++]=U[l*s+m+t]}if("number"==typeof e)e=e.toString();var i=s(this._shape),a=this._parseRanges(e),o=a[0],l=a[1];if(o.length>this._shape.length)throw new Error("Too many indices");var r,V=o.length;if(l.length)t=new _(this._dtype),t.initFromShape(l),r=t._array;else r=[];var U=this._array,h=0;if(n(0,0),l.length)return t;else return r[0]},set:function(e,t){if("number"==typeof e)e=e.toString();var n=s(this._shape),i=this._parseRanges(e),a=i[0],o=i[1];if(a.length>this._shape.length)throw new Error("Too many indices");var V="number"==typeof t,U=a.length,h=this._array;if(V)var m=t;else{if(!l(o,t.shape()))throw new Error(r(o,t.shape()));var m=t._array}var p=0,d=function(e,t){var i=a[e],o=n[e];if(U-1>e)if(i[2]>0)for(var s=i[0];s<i[1];s+=i[2])d(e+1,t+o*s);else for(var s=i[0];s>i[1];s+=i[2])d(e+1,t+o*s);else if(i[2]>0)for(var s=i[0];s<i[1];s+=i[2])for(var l=0;o>l;l++)if(V)h[s*o+l+t]=m;else h[s*o+l+t]=m[p++];else for(var s=i[0];s>i[1];s+=i[2])for(var l=0;o>l;l++)if(V)h[s*o+l+t]=m;else h[s*o+l+t]=m[p++]};return d(0,0),this},insert:h(function(e,t,i){var a=this._array,s=!1;if("number"==typeof e)e=[e],s=!0;if("number"==typeof t)t=new _([t]);else if(t instanceof Array)t=new _(t);if("undefined"==typeof i)this._shape=[this._size],i=0;for(var l=e[0],V=this._shape[i],h=0;h<e.length;h++){if(e[h]<0)e[h]=V+e[h];if(e[h]>V)throw new Error(U(e[h]));if(e[h]<l)throw new Error("Index must be in ascending order");l=e[h]}var m=this._shape.slice();if(s)m.splice(i,1);else m[i]=e.length;for(var d=t._shape,c=d.length-1,b=m.length-1,y=t;c>=0&&b>=0;){if(1===d[c])y=t.repeat(m[b],c);else if(d[c]!==m[b])throw new Error(r(d,m));c--,b--}t=y;for(var k=o(this._shape,i),V=this._shape[i],f=V*k,u=this._size/f,g=e.length,L=new Uint32Array(u*g),x=0,W=0;W<this._size;W+=f)for(var h=0;g>h;h++){var X=e[h];L[x++]=W+X*k}var K=this._shape.slice();K[i]+=e.length;var w=n(K);if(this._array.length<w)var a=new p[this._dtype](w);else var a=this._array;for(var I=this._array,J=t._array,C=L.length-1,v=this._size,S=L[C],F=w-1,A=t._size-1;C>=0;){for(var h=v-1;h>=S;h--)a[F--]=I[h];v=S,S=L[--C];for(var h=0;k>h;h++){if(0>A)A=t._size-1;a[F--]=J[A--]}}for(var h=v-1;h>=0;h--)a[F--]=I[h];return this._array=a,this._shape=K,this._size=w,this}),append:function(){console.warn("TODO")},"delete":h(function(e,t){var i=this._array;if("number"==typeof e)e=[e];var a=this._size;if("undefined"==typeof t)this._shape=[a],t=0;for(var s=o(this._shape,t),l=this._shape[t],r=s*l,V=0,h=0;a>h;h+=r){for(var m=0,p=e[0],d=0;d<e.length;){if(0>p)p+=l;if(p>l)throw new Error(U(p));if(m>p)throw new Error("Index must be in ascending order");for(var c=m;p>c;c++)for(var b=0;s>b;b++)i[V++]=i[c*s+b+h];m=p+1,p=e[++d]}for(var c=m;l>c;c++)for(var b=0;s>b;b++)i[V++]=i[c*s+b+h]}return this._shape[t]-=e.length,this._size=n(this._shape),this}),_parseRanges:function(e){for(var n=e.split(/\s*,\s*/),i=[],a=[],o=0,s=0;s<n.length;s++)if("..."===n[s])for(var l=this._shape.length-(n.length-s);l>=o;)i.push([0,this._shape[o],1]),a.push(this._shape[o]),o++;else{var r=t(n[s],this._shape[o]);if(i.push(r),n[s].indexOf(":")>=0){var V=Math.floor((r[1]-r[0])/r[2]);V=0>V?0:V,a.push(V)}o++}for(;o<this._shape.length;o++)a.push(this._shape[o]);return[i,a]},toArray:function(){function e(o,s){for(var l=i[o],r=0;l>r;r++)if(a-1>o)e(o+1,s[r]=[]);else s[r]=t[n++]}var t=this._array,n=0,i=this._shape,a=i.length,o=[];return e(0,o),o},copy:function(){var e=new _;return e._array=m.call(this._array),e._shape=this._shape.slice(),e._dtype=this._dtype,e._size=this._size,e},constructor:_},_.range=h(function(e,t,n,i){var a=m.call(arguments),o=a[a.length-1];if("string"==typeof o){var i=o;a.pop()}if(1===a.length)t=a[0],n=1,e=0;else if(2==a.length)n=1;i=i||"number";for(var s=new p[i](Math.ceil((t-e)/n)),l=0,r=e;t>r;r+=n)s[l++]=r;var V=new _;return V._array=s,V._shape=[s.length],V._dtype=i,V._size=s.length,V}),_.zeros=h(function(e,t){var n=new _(t);return n.initFromShape(e),n}),_});