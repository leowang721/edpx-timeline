/*! @2014 Leo Wang. All Rights Reserved */
function encodePolygon(e,t){var n="",i=quantize(e[0][0]),a=quantize(e[0][1]);t[0]=i,t[1]=a;for(var o=0;o<e.length;o++){var s=e[o];n+=encode(s[0],i),n+=encode(s[1],a),i=quantize(s[0]),a=quantize(s[1])}return n}function addAMDWrapper(e){return["define(function() {","    return "+e+";","});"].join("\n")}function encode(e,t){if(e=quantize(e),e-=t,(e<<1^e>>15)+64===8232)e--;return e=e<<1^e>>15,String.fromCharCode(e+64)}function quantize(e){return Math.ceil(1024*e)}var fs=require("fs"),glob=require("glob");glob("geoJson/*.json",{},function(e,t){t.forEach(function(e){var t="../"+e.replace(".json",".js"),n=fs.readFileSync(e,"utf8"),i=JSON.parse(n);console.log(t),i.UTF8Encoding=!0;var a=i.features;if(a)a.forEach(function(e){var t=e.geometry.encodeOffsets=[],n=e.geometry.coordinates;if("Polygon"===e.geometry.type)n.forEach(function(e,i){n[i]=encodePolygon(e,t[i]=[])});else if("MultiPolygon"===e.geometry.type)n.forEach(function(e,i){t[i]=[],e.forEach(function(e,a){n[i][a]=encodePolygon(e,t[i][a]=[])})})}),fs.writeFileSync(t,addAMDWrapper(JSON.stringify(i)),"utf8")})});