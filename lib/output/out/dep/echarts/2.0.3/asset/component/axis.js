/*! @2014 Leo Wang. All Rights Reserved */
define("echarts/component/axis",["require","./base","zrender/shape/Line","../config","../util/ecData","zrender/tool/util","zrender/tool/color","./categoryAxis","./valueAxis","../component"],function(require){function e(e,i,s,a,o,r){t.call(this,e,i,s,a,o),this.axisType=r,this._axisList=[],this.refresh(a)}var t=require("./base"),i=require("zrender/shape/Line"),s=require("../config"),a=require("../util/ecData"),o=require("zrender/tool/util"),r=require("zrender/tool/color");return e.prototype={type:s.COMPONENT_TYPE_AXIS,axisBase:{_buildAxisLine:function(){var e=this.option.axisLine.lineStyle.width,t=e/2,s={_axisShape:"axisLine",zlevel:this._zlevelBase+1,hoverable:!1};switch(this.option.position){case"left":s.style={xStart:this.grid.getX()-t,yStart:this.grid.getYend(),xEnd:this.grid.getX()-t,yEnd:this.grid.getY(),lineCap:"round"};break;case"right":s.style={xStart:this.grid.getXend()+t,yStart:this.grid.getYend(),xEnd:this.grid.getXend()+t,yEnd:this.grid.getY(),lineCap:"round"};break;case"bottom":s.style={xStart:this.grid.getX(),yStart:this.grid.getYend()+t,xEnd:this.grid.getXend(),yEnd:this.grid.getYend()+t,lineCap:"round"};break;case"top":s.style={xStart:this.grid.getX(),yStart:this.grid.getY()-t,xEnd:this.grid.getXend(),yEnd:this.grid.getY()-t,lineCap:"round"}}if(""!==this.option.name){if(s.style.text=this.option.name,s.style.textPosition=this.option.nameLocation,s.style.textFont=this.getFont(this.option.nameTextStyle),this.option.nameTextStyle.align)s.style.textAlign=this.option.nameTextStyle.align;if(this.option.nameTextStyle.baseline)s.style.textBaseline=this.option.nameTextStyle.baseline;if(this.option.nameTextStyle.color)s.style.textColor=this.option.nameTextStyle.color}if(s.style.strokeColor=this.option.axisLine.lineStyle.color,s.style.lineWidth=e,this.isHorizontal())s.style.yStart=s.style.yEnd=this.subPixelOptimize(s.style.yEnd,e);else s.style.xStart=s.style.xEnd=this.subPixelOptimize(s.style.xEnd,e);s.style.lineType=this.option.axisLine.lineStyle.type,s=new i(s),this.shapeList.push(s)},_axisLabelClickable:function(e,t){if(e)return a.pack(t,void 0,-1,void 0,-1,t.style.text),t.hoverable=!0,t.clickable=!0,t.highlightStyle={color:r.lift(t.style.color,1),brushType:"fill"},t;else return t},refixAxisShape:function(e,t){if(this.option.axisLine.onZero){var i;if(this.isHorizontal()&&"undefined"!=typeof t)for(var s=0,a=this.shapeList.length;a>s;s++)if("axisLine"==this.shapeList[s]._axisShape)this.shapeList[s].style.yStart=this.shapeList[s].style.yEnd=this.subPixelOptimize(t,this.shapeList[s].stylelineWidth),this.zr.modShape(this.shapeList[s].id);else if("axisTick"==this.shapeList[s]._axisShape)i=this.shapeList[s].style.yEnd-this.shapeList[s].style.yStart,this.shapeList[s].style.yStart=t-i,this.shapeList[s].style.yEnd=t,this.zr.modShape(this.shapeList[s].id);if(!this.isHorizontal()&&"undefined"!=typeof e)for(var s=0,a=this.shapeList.length;a>s;s++)if("axisLine"==this.shapeList[s]._axisShape)this.shapeList[s].style.xStart=this.shapeList[s].style.xEnd=this.subPixelOptimize(e,this.shapeList[s].stylelineWidth),this.zr.modShape(this.shapeList[s].id);else if("axisTick"==this.shapeList[s]._axisShape)i=this.shapeList[s].style.xEnd-this.shapeList[s].style.xStart,this.shapeList[s].style.xStart=e,this.shapeList[s].style.xEnd=e+i,this.zr.modShape(this.shapeList[s].id)}},getPosition:function(){return this.option.position},isHorizontal:function(){return"bottom"==this.option.position||"top"==this.option.position}},reformOption:function(e){if(!e||e instanceof Array&&0===e.length)e=[{type:s.COMPONENT_TYPE_AXIS_VALUE}];else if(!(e instanceof Array))e=[e];if(e.length>2)e=[e[0],e[1]];if("xAxis"==this.axisType){if(!e[0].position||"bottom"!=e[0].position&&"top"!=e[0].position)e[0].position="bottom";if(e.length>1)e[1].position="bottom"==e[0].position?"top":"bottom";for(var t=0,i=e.length;i>t;t++)e[t].type=e[t].type||"category",e[t].xAxisIndex=t,e[t].yAxisIndex=-1}else{if(!e[0].position||"left"!=e[0].position&&"right"!=e[0].position)e[0].position="left";if(e.length>1)e[1].position="left"==e[0].position?"right":"left";for(var t=0,i=e.length;i>t;t++)e[t].type=e[t].type||"value",e[t].xAxisIndex=-1,e[t].yAxisIndex=t}return e},refresh:function(e){var t;if(e){if(this.option=e,"xAxis"==this.axisType)this.option.xAxis=this.reformOption(e.xAxis),t=this.option.xAxis;else this.option.yAxis=this.reformOption(e.yAxis),t=this.option.yAxis;this.series=e.series}for(var i=require("./categoryAxis"),s=require("./valueAxis"),a=Math.max(t&&t.length||0,this._axisList.length),o=0;a>o;o++){if(this._axisList[o]&&e&&(!t[o]||this._axisList[o].type!=t[o].type))this._axisList[o].dispose&&this._axisList[o].dispose(),this._axisList[o]=!1;if(this._axisList[o])this._axisList[o].refresh&&this._axisList[o].refresh(t?t[o]:!1,this.series);else if(t&&t[o])this._axisList[o]="category"==t[o].type?new i(this.ecTheme,this.messageCenter,this.zr,t[o],this.myChart,this.axisBase):new s(this.ecTheme,this.messageCenter,this.zr,t[o],this.myChart,this.axisBase,this.series)}},getAxis:function(e){return this._axisList[e]},clear:function(){for(var e=0,t=this._axisList.length;t>e;e++)this._axisList[e].dispose&&this._axisList[e].dispose();this._axisList=[]}},o.inherits(e,t),require("../component").define("axis",e),e});