/*! @2014 Leo Wang. All Rights Reserved */
define("echarts/component/title",["require","./base","zrender/shape/Text","zrender/shape/Rectangle","../config","zrender/tool/util","zrender/tool/area","zrender/tool/color","../component"],function(require){function e(e,i,s,a,o){t.call(this,e,i,s,a,o),this.refresh(a)}var t=require("./base"),i=require("zrender/shape/Text"),s=require("zrender/shape/Rectangle"),a=require("../config"),o=require("zrender/tool/util"),n=require("zrender/tool/area"),h=require("zrender/tool/color");return e.prototype={type:a.COMPONENT_TYPE_TITLE,_buildShape:function(){this._itemGroupLocation=this._getItemGroupLocation(),this._buildBackground(),this._buildItem();for(var e=0,t=this.shapeList.length;t>e;e++)this.zr.addShape(this.shapeList[e])},_buildItem:function(){var e=this.titleOption.text,t=this.titleOption.link,s=this.titleOption.target,a=this.titleOption.subtext,o=this.titleOption.sublink,n=this.titleOption.subtarget,r=this.getFont(this.titleOption.textStyle),l=this.getFont(this.titleOption.subtextStyle),d=this._itemGroupLocation.x,p=this._itemGroupLocation.y,c=this._itemGroupLocation.width,f=this._itemGroupLocation.height,u={zlevel:this._zlevelBase,style:{y:p,color:this.titleOption.textStyle.color,text:e,textFont:r,textBaseline:"top"},highlightStyle:{color:h.lift(this.titleOption.textStyle.color,1),brushType:"fill"},hoverable:!1};if(t)u.hoverable=!0,u.clickable=!0,u.onclick=function(){if(!s||"self"!=s)window.open(t);else window.location=t};var g={zlevel:this._zlevelBase,style:{y:p+f,color:this.titleOption.subtextStyle.color,text:a,textFont:l,textBaseline:"bottom"},highlightStyle:{color:h.lift(this.titleOption.subtextStyle.color,1),brushType:"fill"},hoverable:!1};if(o)g.hoverable=!0,g.clickable=!0,g.onclick=function(){if(!n||"self"!=n)window.open(o);else window.location=o};switch(this.titleOption.x){case"center":u.style.x=g.style.x=d+c/2,u.style.textAlign=g.style.textAlign="center";break;case"left":u.style.x=g.style.x=d,u.style.textAlign=g.style.textAlign="left";break;case"right":u.style.x=g.style.x=d+c,u.style.textAlign=g.style.textAlign="right";break;default:d=this.titleOption.x-0,d=isNaN(d)?0:d,u.style.x=g.style.x=d}if(this.titleOption.textAlign)u.style.textAlign=g.style.textAlign=this.titleOption.textAlign;this.shapeList.push(new i(u)),""!==a&&this.shapeList.push(new i(g))},_buildBackground:function(){var e=this.titleOption.padding[0],t=this.titleOption.padding[1],i=this.titleOption.padding[2],a=this.titleOption.padding[3];this.shapeList.push(new s({zlevel:this._zlevelBase,hoverable:!1,style:{x:this._itemGroupLocation.x-a,y:this._itemGroupLocation.y-e,width:this._itemGroupLocation.width+a+t,height:this._itemGroupLocation.height+e+i,brushType:0===this.titleOption.borderWidth?"fill":"both",color:this.titleOption.backgroundColor,strokeColor:this.titleOption.borderColor,lineWidth:this.titleOption.borderWidth}}))},_getItemGroupLocation:function(){var e,t=this.titleOption.text,i=this.titleOption.subtext,s=this.getFont(this.titleOption.textStyle),a=this.getFont(this.titleOption.subtextStyle),o=Math.max(n.getTextWidth(t,s),n.getTextWidth(i,a)),h=n.getTextHeight(t,s)+(""===i?0:this.titleOption.itemGap+n.getTextHeight(i,a)),r=this.zr.getWidth();switch(this.titleOption.x){case"center":e=Math.floor((r-o)/2);break;case"left":e=this.titleOption.padding[3]+this.titleOption.borderWidth;break;case"right":e=r-o-this.titleOption.padding[1]-this.titleOption.borderWidth;break;default:e=this.titleOption.x-0,e=isNaN(e)?0:e}var l,d=this.zr.getHeight();switch(this.titleOption.y){case"top":l=this.titleOption.padding[0]+this.titleOption.borderWidth;break;case"bottom":l=d-h-this.titleOption.padding[2]-this.titleOption.borderWidth;break;case"center":l=Math.floor((d-h)/2);break;default:l=this.titleOption.y-0,l=isNaN(l)?0:l}return{x:e,y:l,width:o,height:h}},refresh:function(e){if(e)this.option=e,this.option.title=this.reformOption(this.option.title),this.option.title.padding=this.reformCssArray(this.option.title.padding),this.titleOption=this.option.title,this.titleOption.textStyle=o.merge(this.titleOption.textStyle,this.ecTheme.textStyle),this.titleOption.subtextStyle=o.merge(this.titleOption.subtextStyle,this.ecTheme.textStyle);this.clear(),this._buildShape()}},o.inherits(e,t),require("../component").define("title",e),e});