/*! @2014 Leo Wang. All Rights Reserved */
define("echarts/echarts",["require","./config","zrender/tool/util","zrender/tool/event","zrender/tool/env","zrender","zrender/config","./chart/island","./component/toolbox","./component","./component/title","./component/tooltip","./component/legend","./util/ecData","./chart","zrender/tool/color","./component/timeline","zrender/shape/Image","zrender/loadingEffect/Bar","zrender/loadingEffect/Bubble","zrender/loadingEffect/DynamicLine","zrender/loadingEffect/Ring","zrender/loadingEffect/Spin","zrender/loadingEffect/Whirling","./theme/default"],function(require){function e(){a.Dispatcher.call(this)}function t(t){this._themeConfig=o.clone(s),this.dom=t,this._connected=!1,this._status={dragIn:!1,dragOut:!1,needRefresh:!1},this._curEventType=!1,this._chartList=[],this._messageCenter=new e,this._messageCenterOutSide=new e,this.resize=this.resize(),this._init()}function i(e,t,i,s,o){for(var a=e._chartList,n=a.length;n--;){var r=a[n];if("function"==typeof r[t])r[t](i,s,o)}}var s=require("./config"),o=require("zrender/tool/util"),a=require("zrender/tool/event"),n={},r=require("zrender/tool/env").canvasSupported,h=new Date-0,l={},d="_echarts_instance_";n.version="2.0.3",n.dependencies={zrender:"2.0.3"},n.init=function(e,i){var s=require("zrender");if((s.version||"1.0.3").replace(".","")-0<n.dependencies.zrender.replace(".","")-0)console.error("ZRender "+(s.version||"1.0.3-")+" is too old for ECharts "+n.version+". Current version need ZRender "+n.dependencies.zrender+"+");e=e instanceof Array?e[0]:e;var o=e.getAttribute(d);if(!o)o=h++,e.setAttribute(d,o);if(l[o])l[o].dispose();return l[o]=new t(e),l[o].id=o,l[o].setTheme(i),l[o]},n.getInstanceById=function(e){return l[e]},o.merge(e.prototype,a.Dispatcher.prototype,!0);var p=require("zrender/config").EVENT,c=["CLICK","DBLCLICK","MOUSEOVER","MOUSEOUT","DRAGSTART","DRAGEND","DRAGENTER","DRAGOVER","DRAGLEAVE","DROP"];return t.prototype={_init:function(){var e=this,t=require("zrender").init(this.dom);this._zr=t,this._messageCenter.dispatch=function(t,i,s,o){if(s=s||{},s.type=t,s.event=i,e._messageCenter.dispatchWithContext(t,s,o),"HOVER"!=t&&"MOUSEOUT"!=t)setTimeout(function(){e._messageCenterOutSide.dispatchWithContext(t,s,o)},50);else e._messageCenterOutSide.dispatchWithContext(t,s,o)},this._onevent=function(t){return e.__onevent(t)};for(var i in s.EVENT)if("CLICK"!=i&&"DBLCLICK"!=i&&"HOVER"!=i&&"MOUSEOUT"!=i&&"MAP_ROAM"!=i)this._messageCenter.bind(s.EVENT[i],this._onevent,this);var o={};this._onzrevent=function(t){return e[o[t.type]](t)};for(var a=0,n=c.length;n>a;a++){var r=c[a],h=p[r];o[h]="_on"+r.toLowerCase(),t.on(h,this._onzrevent)}this.chart={},this.component={};var l=require("./chart/island");this._island=new l(this._themeConfig,this._messageCenter,t,{},this),this.chart.island=this._island;var d=require("./component/toolbox");this._toolbox=new d(this._themeConfig,this._messageCenter,t,{},this),this.component.toolbox=this._toolbox;var f=require("./component");if(f.define("title",require("./component/title")),f.define("tooltip",require("./component/tooltip")),f.define("legend",require("./component/legend")),0===t.getWidth()||0===t.getHeight())console.error("Domâ€™s width & height should be ready before init.")},__onevent:function(e){e.__echartsId=e.__echartsId||this.id;var t=e.__echartsId==this.id;if(!this._curEventType)this._curEventType=e.type;switch(e.type){case s.EVENT.LEGEND_SELECTED:this._onlegendSelected(e);break;case s.EVENT.DATA_ZOOM:if(!t){var i=this.component.dataZoom;if(i)i.silence(!0),i.absoluteZoom(e.zoom),i.silence(!1)}this._ondataZoom(e);break;case s.EVENT.DATA_RANGE:t&&this._ondataRange(e);break;case s.EVENT.MAGIC_TYPE_CHANGED:if(!t){var o=this.component.toolbox;if(o)o.silence(!0),o.setMagicType(e.magicType),o.silence(!1)}this._onmagicTypeChanged(e);break;case s.EVENT.DATA_VIEW_CHANGED:t&&this._ondataViewChanged(e);break;case s.EVENT.TOOLTIP_HOVER:t&&this._tooltipHover(e);break;case s.EVENT.RESTORE:this._onrestore();break;case s.EVENT.REFRESH:t&&this._onrefresh(e);break;case s.EVENT.TOOLTIP_IN_GRID:case s.EVENT.TOOLTIP_OUT_GRID:if(!t){var a=this.component.grid;if(a)this._zr.trigger("mousemove",{connectTrigger:!0,zrenderX:a.getX()+e.x*a.getWidth(),zrenderY:a.getY()+e.y*a.getHeight()})}else if(this._connected){var a=this.component.grid;if(a)e.x=(e.event.zrenderX-a.getX())/a.getWidth(),e.y=(e.event.zrenderY-a.getY())/a.getHeight()}}if(this._connected&&t&&this._curEventType==e.type){for(var n in this._connected)this._connected[n].connectedEventHandler(e);this._curEventType=null}if(!t||!this._connected&&t)this._curEventType=null},_onclick:function(e){if(i(this,"onclick",e),e.target){var t=this._eventPackage(e.target);if(t&&null!=t.seriesIndex)this._messageCenter.dispatch(s.EVENT.CLICK,e.event,t,this)}},_ondblclick:function(e){if(i(this,"ondblclick",e),e.target){var t=this._eventPackage(e.target);if(t&&null!=t.seriesIndex)this._messageCenter.dispatch(s.EVENT.DBLCLICK,e.event,t,this)}},_onmouseover:function(e){if(e.target){var t=this._eventPackage(e.target);if(t&&null!=t.seriesIndex)this._messageCenter.dispatch(s.EVENT.HOVER,e.event,t,this)}},_onmouseout:function(e){if(e.target){var t=this._eventPackage(e.target);if(t&&null!=t.seriesIndex)this._messageCenter.dispatch(s.EVENT.MOUSEOUT,e.event,t,this)}},_ondragstart:function(e){this._status={dragIn:!1,dragOut:!1,needRefresh:!1},i(this,"ondragstart",e)},_ondragenter:function(e){i(this,"ondragenter",e)},_ondragover:function(e){i(this,"ondragover",e)},_ondragleave:function(e){i(this,"ondragleave",e)},_ondrop:function(e){i(this,"ondrop",e,this._status),this._island.ondrop(e,this._status)},_ondragend:function(e){if(i(this,"ondragend",e,this._status),this._timeline&&this._timeline.ondragend(e,this._status),this._island.ondragend(e,this._status),this._status.needRefresh){this._syncBackupData(this._option);var t=this._messageCenter;t.dispatch(s.EVENT.DATA_CHANGED,e.event,this._eventPackage(e.target),this),t.dispatch(s.EVENT.REFRESH,null,null,this)}},_onlegendSelected:function(e){if(this._status.needRefresh=!1,i(this,"onlegendSelected",e,this._status),this._status.needRefresh)this._messageCenter.dispatch(s.EVENT.REFRESH,null,null,this)},_ondataZoom:function(e){if(this._status.needRefresh=!1,i(this,"ondataZoom",e,this._status),this._status.needRefresh)this._messageCenter.dispatch(s.EVENT.REFRESH,null,null,this)},_ondataRange:function(e){if(this._clearEffect(),this._status.needRefresh=!1,i(this,"ondataRange",e,this._status),this._status.needRefresh)this._zr.refresh()},_onmagicTypeChanged:function(){this._clearEffect(),this._render(this._toolbox.getMagicOption())},_ondataViewChanged:function(e){this._syncBackupData(e.option),this._messageCenter.dispatch(s.EVENT.DATA_CHANGED,null,e,this),this._messageCenter.dispatch(s.EVENT.REFRESH,null,null,this)},_tooltipHover:function(e){var t=[];i(this,"ontooltipHover",e,t)},_onrestore:function(){this.restore()},_onrefresh:function(e){this._refreshInside=!0,this.refresh(e),this._refreshInside=!1},_syncBackupData:function(e){this.component.dataZoom&&this.component.dataZoom.syncBackupData(e)},_eventPackage:function(e){if(e){var t=require("./util/ecData"),i=t.get(e,"seriesIndex"),s=t.get(e,"dataIndex");return s=-1!=i&&this.component.dataZoom?this.component.dataZoom.getRealDataIndex(i,s):s,{seriesIndex:i,seriesName:(t.get(e,"series")||{}).name,dataIndex:s,data:t.get(e,"data"),name:t.get(e,"name"),value:t.get(e,"value"),special:t.get(e,"special")}}},_render:function(e){this._mergeGlobalConifg(e);var t=e.backgroundColor;if(t)if(!r&&-1!=t.indexOf("rgba")){var i=t.split(",");this.dom.style.filter="alpha(opacity="+100*i[3].substring(0,i[3].lastIndexOf(")"))+")",i.length=3,i[0]=i[0].replace("a",""),this.dom.style.backgroundColor=i.join(",")+")"}else this.dom.style.backgroundColor=t;this._zr.clearAnimation(),this._chartList=[];var o=require("./chart"),a=require("./component");if(e.xAxis||e.yAxis)e.grid=e.grid||{},e.dataZoom=e.dataZoom||{};for(var n,h,l,d=["title","legend","tooltip","dataRange","roamController","grid","dataZoom","xAxis","yAxis","polar"],p=0,c=d.length;c>p;p++)if(h=d[p],l=this.component[h],e[h]){if(l)l.refresh&&l.refresh(e);else n=a.get(/^[xy]Axis$/.test(h)?"axis":h),l=new n(this._themeConfig,this._messageCenter,this._zr,e,this,h),this.component[h]=l;this._chartList.push(l)}else if(l)l.dispose(),this.component[h]=null,delete this.component[h];for(var f,u,g,_={},p=0,c=e.series.length;c>p;p++)if(u=e.series[p].type){if(!_[u])if(_[u]=!0,f=o.get(u)){if(this.chart[u])g=this.chart[u],g.refresh(e);else g=new f(this._themeConfig,this._messageCenter,this._zr,e,this);this._chartList.push(g),this.chart[u]=g}else console.error(u+" has not been required.")}else console.error("series["+p+"] chart type has not been defined.");for(u in this.chart)if(u!=s.CHART_TYPE_ISLAND&&!_[u])this.chart[u].dispose(),this.chart[u]=null,delete this.chart[u];this.component.grid&&this.component.grid.refixAxisShape(this.component),this._island.refresh(e),this._toolbox.refresh(e),e.animation&&!e.renderAsImage?this._zr.refresh():this._zr.render();var m="IMG"+this.id,y=document.getElementById(m);if(e.renderAsImage&&r){if(y)y.src=this.getDataURL(e.renderAsImage);else y=this.getImage(e.renderAsImage),y.id=m,y.style.position="absolute",y.style.left=0,y.style.top=0,this.dom.firstChild.appendChild(y);this.un(),this._zr.un(),this._disposeChartList(),this._zr.clear()}else if(y)y.parentNode.removeChild(y);y=null,this._option=e},restore:function(){this._clearEffect(),this._option=o.clone(this._optionRestore),this._disposeChartList(),this._island.clear(),this._toolbox.reset(this._option,!0),this._render(this._option)},refresh:function(e){this._clearEffect(),e=e||{};var t=e.option;if(!this._refreshInside&&t)t=this.getOption(),o.merge(t,e.option,!0),o.merge(this._optionRestore,e.option,!0),this._toolbox.reset(t);this._island.refresh(t),this._toolbox.refresh(t),this._zr.clearAnimation();for(var i=0,s=this._chartList.length;s>i;i++)this._chartList[i].refresh&&this._chartList[i].refresh(t);this.component.grid&&this.component.grid.refixAxisShape(this.component),this._zr.refresh()},_disposeChartList:function(){this._clearEffect(),this._zr.clearAnimation();for(var e=this._chartList.length;e--;){var t=this._chartList[e];if(t){var i=t.type;this.chart[i]&&delete this.chart[i],this.component[i]&&delete this.component[i],t.dispose&&t.dispose()}}this._chartList=[]},_mergeGlobalConifg:function(e){for(var t=["backgroundColor","calculable","calculableColor","calculableHolderColor","nameConnector","valueConnector","animation","animationThreshold","animationDuration","animationEasing","addDataAnimation","symbolList","DRAG_ENABLE_TIME"],i=t.length;i--;){var s=t[i];if(null==e[s])e[s]=this._themeConfig[s]}var o=e.color;if(!o||!o.length)o=this._themeConfig.color;this._zr.getColor=function(e){var t=require("zrender/tool/color");return t.getColor(e,o)}},setOption:function(e,t){if(!e.timeline)return this._setOption(e,t);else return this._setTimelineOption(e)},_setOption:function(e,t){if(!t&&this._option)this._option=o.merge(this.getOption(),o.clone(e),!0);else this._option=o.clone(e);if(this._optionRestore=o.clone(this._option),!this._option.series||0===this._option.series.length)return void this._zr.clear();if(this.component.dataZoom&&(this._option.dataZoom||this._option.toolbox&&this._option.toolbox.feature&&this._option.toolbox.feature.dataZoom&&this._option.toolbox.feature.dataZoom.show))this.component.dataZoom.syncOption(this._option);return this._toolbox.reset(this._option),this._render(this._option),this},getOption:function(){function e(e){var s=i._optionRestore[e];if(s)if(s instanceof Array)for(var a=s.length;a--;)t[e][a].data=o.clone(s[a].data);else t[e].data=o.clone(s.data)}var t=o.clone(this._option),i=this;return e("xAxis"),e("yAxis"),e("series"),t},setSeries:function(e,t){if(!t)this.setOption({series:e});else this._option.series=e,this.setOption(this._option,t);return this},getSeries:function(){return this.getOption().series},_setTimelineOption:function(e){this._timeline&&this._timeline.dispose();var t=require("./component/timeline"),i=new t(this._themeConfig,this._messageCenter,this._zr,e,this);return this._timeline=i,this.component.timeline=this._timeline,this},addData:function(e,t,i,a,n){for(var r=e instanceof Array?e:[[e,t,i,a,n]],h=this.getOption(),l=this._optionRestore,d=0,p=r.length;p>d;d++){e=r[d][0],t=r[d][1],i=r[d][2],a=r[d][3],n=r[d][4];var c=l.series[e],f=i?"unshift":"push",u=i?"pop":"shift";if(c){var g=c.data,_=h.series[e].data;if(g[f](t),_[f](t),!a)g[u](),t=_[u]();if(null!=n){var m,y;if(c.type==s.CHART_TYPE_PIE&&(m=l.legend)&&(y=m.data)){var x=h.legend.data;if(y[f](n),x[f](n),!a){var v=o.indexOf(y,t.name);-1!=v&&y.splice(v,1),v=o.indexOf(x,t.name),-1!=v&&x.splice(v,1)}}else if(null!=l.xAxis&&null!=l.yAxis){var b,S,T=c.xAxisIndex||0;if("undefined"==typeof l.xAxis[T].type||"category"==l.xAxis[T].type)if(b=l.xAxis[T].data,S=h.xAxis[T].data,b[f](n),S[f](n),!a)b[u](),S[u]();if(T=c.yAxisIndex||0,"category"==l.yAxis[T].type)if(b=l.yAxis[T].data,S=h.yAxis[T].data,b[f](n),S[f](n),!a)b[u](),S[u]()}}this._option.series[e].data=h.series[e].data}}this._zr.clearAnimation();for(var z=this._chartList,d=0,p=z.length;p>d;d++)if(h.addDataAnimation&&z[d].addDataAnimation)z[d].addDataAnimation(r);this.component.dataZoom&&this.component.dataZoom.syncOption(h),this._option=h;var C=this;return setTimeout(function(){if(C._zr){C._zr.clearAnimation();for(var e=0,t=z.length;t>e;e++)z[e].motionlessOnce=h.addDataAnimation&&z[e].addDataAnimation;C._messageCenter.dispatch(s.EVENT.REFRESH,null,{option:h},C)}},h.addDataAnimation?500:0),this},addMarkPoint:function(e,t){return this._addMark(e,t,"markPoint")},addMarkLine:function(e,t){return this._addMark(e,t,"markLine")},_addMark:function(e,t,i){var s,a=this._option.series;if(a&&(s=a[e])){var n=this._optionRestore.series,r=n[e],h=s[i],l=r[i];h=s[i]=h||{data:[]},l=r[i]=l||{data:[]};for(var d in t)if("data"==d)h.data=h.data.concat(t.data),l.data=l.data.concat(t.data);else if("object"!=typeof t[d]||"undefined"==typeof h[d])h[d]=l[d]=t[d];else o.merge(h[d],t[d],!0),o.merge(l[d],t[d],!0);var p=this.chart[s.type];p&&p.addMark(e,t,i)}return this},delMarkPoint:function(e,t){return this._delMark(e,t,"markPoint")},delMarkLine:function(e,t){return this._delMark(e,t,"markLine")},_delMark:function(e,t,i){var s,o,a,n=this._option.series;if(!(n&&(s=n[e])&&(o=s[i])&&(a=o.data)))return this;t=t.split(" > ");for(var r=-1,h=0,l=a.length;l>h;h++){var d=a[h];if(d instanceof Array){if(d[0].name==t[0]&&d[1].name==t[1]){r=h;break}}else if(d.name==t[0]){r=h;break}}if(r>-1){a.splice(r,1),this._optionRestore.series[e][i].data.splice(r,1);var p=this.chart[s.type];p&&p.delMark(e,t.join(" > "),i)}return this},getDom:function(){return this.dom},getZrender:function(){return this._zr},getDataURL:function(e){if(!r)return"";if(0===this._chartList.length){var t="IMG"+this.id,i=document.getElementById(t);if(i)return i.src}var s=this.component.tooltip;switch(s&&s.hideTip(),e){case"jpeg":break;default:e="png"}var o=this._option.backgroundColor;if(o&&"rgba(0,0,0,0)"==o.replace(" ",""))o="#fff";return this._zr.toDataURL("image/"+e,o)},getImage:function(e){var t=this._optionRestore.title,i=document.createElement("img");return i.src=this.getDataURL(e),i.title=t&&t.text||"ECharts",i},getConnectedDataURL:function(e){if(!this.isConnected())return this.getDataURL(e);var t=this.dom,i={self:{img:this.getDataURL(e),left:t.offsetLeft,top:t.offsetTop,right:t.offsetLeft+t.offsetWidth,bottom:t.offsetTop+t.offsetHeight}},s=i.self.left,o=i.self.top,a=i.self.right,n=i.self.bottom;for(var r in this._connected)t=this._connected[r].getDom(),i[r]={img:this._connected[r].getDataURL(e),left:t.offsetLeft,top:t.offsetTop,right:t.offsetLeft+t.offsetWidth,bottom:t.offsetTop+t.offsetHeight},s=Math.min(s,i[r].left),o=Math.min(o,i[r].top),a=Math.max(a,i[r].right),n=Math.max(n,i[r].bottom);var h=document.createElement("div");h.style.position="absolute",h.style.left="-4000px",h.style.width=a-s+"px",h.style.height=n-o+"px",document.body.appendChild(h);var l=require("zrender").init(h),d=require("zrender/shape/Image");for(var r in i)l.addShape(new d({style:{x:i[r].left-s,y:i[r].top-o,image:i[r].img}}));l.render();var p=this._option.backgroundColor;if(p&&"rgba(0,0,0,0)"==p.replace(/ /g,""))p="#fff";var c=l.toDataURL("image/png",p);return setTimeout(function(){l.dispose(),h.parentNode.removeChild(h),h=null},100),c},getConnectedImage:function(e){var t=this._optionRestore.title,i=document.createElement("img");return i.src=this.getConnectedDataURL(e),i.title=t&&t.text||"ECharts",i},on:function(e,t){return this._messageCenterOutSide.bind(e,t,this),this},un:function(e,t){return this._messageCenterOutSide.unbind(e,t),this},connect:function(e){if(!e)return this;if(!this._connected)this._connected={};if(e instanceof Array)for(var t=0,i=e.length;i>t;t++)this._connected[e[t].id]=e[t];else this._connected[e.id]=e;return this},disConnect:function(e){if(!e||!this._connected)return this;if(e instanceof Array)for(var t=0,i=e.length;i>t;t++)delete this._connected[e[t].id];else delete this._connected[e.id];for(var s in this._connected)return this;return this._connected=!1,this},connectedEventHandler:function(e){if(e.__echartsId!=this.id)this._onevent(e)},isConnected:function(){return!!this._connected},showLoading:function(e){var t={bar:require("zrender/loadingEffect/Bar"),bubble:require("zrender/loadingEffect/Bubble"),dynamicLine:require("zrender/loadingEffect/DynamicLine"),ring:require("zrender/loadingEffect/Ring"),spin:require("zrender/loadingEffect/Spin"),whirling:require("zrender/loadingEffect/Whirling")};this._toolbox.hideDataView(),e=e||{};var i=e.textStyle||{};e.textStyle=i;var s=o.merge(o.clone(i),this._themeConfig.textStyle);if(i.textFont=s.fontStyle+" "+s.fontWeight+" "+s.fontSize+"px "+s.fontFamily,i.text=e.text||this._themeConfig.loadingText,null!=e.x)i.x=e.x;if(null!=e.y)i.y=e.y;e.effectOption=e.effectOption||{},e.effectOption.textStyle=i;var a=e.effect;if("string"==typeof a||null==a)a=t[e.effect||"spin"];return this._zr.showLoading(new a(e.effectOption)),this},hideLoading:function(){return this._zr.hideLoading(),this},setTheme:function(e){if(e){if("string"==typeof e)switch(e){default:e=require("./theme/default")}else e=e||{};for(var t in this._themeConfig)delete this._themeConfig[t];for(var t in s)this._themeConfig[t]=o.clone(s[t]);e.color&&(this._themeConfig.color=[]),e.symbolList&&(this._themeConfig.symbolList=[]),o.merge(this._themeConfig,o.clone(e),!0)}if(!r)this._themeConfig.textStyle.fontFamily=this._themeConfig.textStyle.fontFamily2;this._timeline&&this._timeline.setTheme(!0),this._optionRestore&&this.restore()},resize:function(){var e=this;return function(){if(e._clearEffect(),e._zr.resize(),e._option&&e._option.renderAsImage&&r)return e._render(e._option),e;e._zr.clearAnimation(),e._island.resize(),e._toolbox.resize(),e._timeline&&e._timeline.resize();for(var t=0,i=e._chartList.length;i>t;t++)e._chartList[t].resize&&e._chartList[t].resize();return e.component.grid&&e.component.grid.refixAxisShape(e.component),e._zr.refresh(),e._messageCenter.dispatch(s.EVENT.RESIZE,null,null,e),e}},_clearEffect:function(){this._zr.modLayer(s.EFFECT_ZLEVEL,{motionBlur:!1}),this._zr.painter.clearLayer(s.EFFECT_ZLEVEL)},clear:function(){return this._disposeChartList(),this._zr.clear(),this._option={},this._optionRestore={},this},dispose:function(){var e=this.dom.getAttribute(d);e&&delete l[e],this._island.dispose(),this._toolbox.dispose(),this._timeline&&this._timeline.dispose(),this._messageCenter.unbind(),this.clear(),this._zr.dispose(),this._zr=null}},n}),define("echarts",["echarts/echarts"],function(e){return e});