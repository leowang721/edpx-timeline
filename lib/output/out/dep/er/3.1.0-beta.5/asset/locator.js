/*! @2014 Leo Wang. All Rights Reserved */
define("er/locator",["require","./config","./events","mini-event/EventTarget"],function(require){function e(){var e=location.href.indexOf("#"),t=-1===e?"":location.href.slice(e);return t}function t(){var t=e();o.redirect(t)}function n(e){if(window.addEventListener)window.addEventListener("hashchange",t,!1);else if("onhashchange"in window&&document.documentMode>7)window.attachEvent("onhashchange",t);else r=setInterval(t,100);if(e)l=setTimeout(t,0)}function i(){if(r)clearInterval(r),r=null;if(l)clearTimeout(l),l=null;if(window.removeEventListener)window.removeEventListener("hashchange",t,!1);else if("onhashchange"in window&&document.documentMode>7)window.detachEvent("onhashchange",t)}function a(t,a){var o=s!==t;if(o&&e()!==t)if(a.silent)i(),location.hash=t,n(!1);else location.hash=t;return s=t,o}var o={},s="",r=0,l=1;return o.start=function(){n(!0)},o.stop=i,o.resolveURL=function(e){if(e+="",0===e.indexOf("#"))e=e.slice(1);if(!e||"/"===e)e=require("./config").indexURL;return e},o.redirect=function(e,t){t=t||{},e=o.resolveURL(e);var n=s,i=a(e,t),r=i||t.force;if(r){if(!t.silent)o.fire("redirect",{url:e,referrer:n});require("./events").fire("redirect",{url:e,referrer:n})}return r},o.reload=function(){if(s)o.redirect(s,{force:!0})},require("mini-event/EventTarget").enable(o),o});